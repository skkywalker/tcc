import numpy as np
import math
import matplotlib.pyplot as plt
import matplotlib.animation as animation
import time

class DifferentialDrive():
    def __init__(self,L,R,x,y,yaw,v=0.0,w=0.0):
        self.L = L
        self.R = R

        self.x = x
        self.y = y
        self.yaw = yaw

        self.v = v
        self.w = w

        self.x_hist = [x]
        self.y_hist = [y]
    
    def update(self, dt):
        self.x += self.v * math.cos(self.yaw) * dt
        self.y += self.v * math.sin(self.yaw) * dt
        self.yaw += self.w * dt
        self.x_hist.append(self.x)
        self.y_hist.append(self.y)

    def get_wheel_speed(self):
        '''
        Returns right & left wheels in m/s
        '''
        left = self.v - self.w*self.L/2
        right = self.v + self.w*self.L/2
        return (left,right)

    def pure_pursuit(self,finish,path,la,t):
        while not (finish[0]+t > self.x and finish[0]-t < self.x and finish[1]+t > self.y and finish[1]-t < self.y):
            # Run algorithm
            print('a')

def norm(p1,p2):
    return(math.sqrt( (p1[0]-p2[0])**2 + (p1[1]-p2[1])**2 ))

def find_closest(robot, path):
    x = robot.x
    y = robot.y
    least = norm((x,y),path[0])
    position = 0
    for i,pos in enumerate(path):
        if(norm((x,y),pos) < least):
            least = norm((x,y),pos)
            position = i
    return position

def lookahead(path,la,i):
    x = path[i][0]
    y = path[i][1]
    for i,pos in enumerate(path[i:]):
        if(norm((x,y),pos) < la):
            continue
        else:
            return pos

def plot_arrow(robot):
    # Main arrow
    ax1.arrow(robot.x, robot.y, 0.1 * math.cos(robot.yaw), 0.1 * math.sin(robot.yaw),
                 fc='r', ec='k', head_width=0.05, head_length=0.05)
    # Sides
    ax1.arrow(robot.x, robot.y, robot.L/2 * math.cos(robot.yaw+math.pi/2), robot.L/2 * math.sin(robot.yaw+math.pi/2),
                 ec='k', head_width=2*robot.R, head_length=0)
    ax1.arrow(robot.x, robot.y, robot.L/2 * math.cos(robot.yaw-math.pi/2), robot.L/2 * math.sin(robot.yaw-math.pi/2),
                 ec='k', head_width=2*robot.R, head_length=0.)


def update(frame):
    global last_updated
    global robot
    global path,pathx,pathy
    ax1.clear()
    ax1.imshow(img,extent=[0, 2, 0, 1.5])
    ax1.set_ylim([0, 1.5])
    ax1.set_xlim([0, 2])
    ax1.set_title(str(round(time.time()-init_time,1)) + " segundos")
    ax1.plot(pathx,pathy, "-k", label="path")
    ax1.plot(robot.x_hist, robot.y_hist, "-b", label="trajectory")
    plot_arrow(robot)

    robot.update(time.time()-last_updated)
    last_updated = time.time()
    if(robot.x > 0.9):
        ani.event_source.stop()
    
path = [(48, 45), (48, 46), (48, 47), (48, 48), (48, 49), (48, 50), (48, 51), (48, 52), (48, 53), (48, 54), (48, 55), (48, 56), (48, 57), (48, 58), (48, 59), (48, 60), (48, 61), (48, 62), (48, 63), (48, 64), (48, 65), (48, 66), (48, 67), (48, 68), (48, 69), (48, 70), (48, 71), (48, 72), (48, 73), (48, 74), (48, 75), (48, 76), (48, 77), (48, 78), (48, 79), (48, 80), (48, 81), (48, 82), (48, 83), (48, 84), (48, 85), (48, 86), (48, 87), (48, 88), (48, 89), (48, 90), (48, 91), (48, 92), (48, 93), (48, 94), (48, 95), (48, 96), (48, 97), (48, 98), (48, 99), (48, 100), (48, 101), (48, 102), (48, 103), (48, 104), (48, 105), (48, 106), (48, 107), (48, 108), (48, 109), (48, 110), (48, 111), (48, 112), (48, 113), (48, 114), (48, 115), (48, 116), (48, 117), (48, 118), (48, 119), (48, 120), (48, 121), (48, 122), (48, 123), (48, 124), (48, 125), (48, 126), (48, 127), (48, 128), (48, 129), (48, 130), (48, 131), (48, 132), (48, 133), (48, 134), (48, 135), (48, 136), (48, 137), (48, 138), (48, 139), (48, 140), (48, 141), (48, 142), (48, 143), (48, 144), (48, 145), (48, 146), (48, 147), (48, 148), (48, 149), (48, 150), (48, 151), (48, 152), (48, 153), (48, 154), (48, 155), (48, 156), (48, 157), (48, 158), (48, 159), (48, 160), (48, 161), (48, 162), (48, 163), (48, 164), (48, 165), (48, 166), (48, 167), (48, 168), (48, 169), (48, 170), (48, 171), (48, 172), (48, 173), (48, 174), (48, 175), (48, 176), (48, 177), (48, 178), (48, 179), (48, 180), (48, 181), (48, 182), (48, 183), (48, 184), (48, 185), (48, 186), (48, 187), (48, 188), (48, 189), (48, 190), (48, 191), (48, 192), (48, 193), (48, 194), (48, 195), (48, 196), (48, 197), (48, 198), (48, 199), (48, 200), (48, 201), (48, 202), (48, 203), (48, 204), (48, 205), (48, 206), (48, 207), (48, 208), (48, 209), (48, 210), (48, 211), (48, 212), (48, 213), (48, 214), (48, 215), (48, 216), (48, 217), (48, 218), (48, 219), (48, 220), (48, 221), (48, 222), (48, 223), (48, 224), (48, 225), (48, 226), (48, 227), (48, 228), (48, 229), (48, 230), (48, 231), (48, 232), (48, 233), (48, 234), (48, 235), (48, 236), (48, 237), (48, 238), (48, 239), (48, 240), (48, 241), (48, 242), (48, 243), (48, 244), (48, 245), (48, 246), (48, 247), (48, 248), (48, 249), (48, 250), (48, 251), (48, 252), (48, 253), (48, 254), (48, 255), (48, 256), (48, 257), (48, 258), (48, 259), (48, 260), (48, 261), (48, 262), (48, 263), (48, 264), (48, 265), (48, 266), (48, 267), (48, 268), (48, 269), (48, 270), (48, 271), (48, 272), (48, 273), (48, 274), (48, 275), (48, 276), (48, 277), (48, 278), (48, 279), (48, 280), (48, 281), (48, 282), (48, 283), (48, 284), (48, 285), (48, 286), (48, 287), (48, 288), (48, 289), (48, 290), (48, 291), (48, 292), (48, 293), (48, 294), (48, 295), (48, 296), (48, 297), (48, 298), (48, 299), (48, 300), (48, 301), (48, 302), (48, 303), (48, 304), (48, 305), (48, 306), (48, 307), (48, 308), (48, 309), (48, 310), (48, 311), (48, 312), (48, 313), (48, 314), (48, 315), (48, 316), (48, 317), (48, 318), (48, 319), (48, 320), (48, 321), (48, 322), (48, 323), (48, 324), (48, 325), (48, 326), (48, 327), (48, 328), (48, 329), (48, 330), (48, 331), (48, 332), (48, 333), (48, 334), (48, 335), (48, 336), (48, 337), (48, 338), (48, 339), (48, 340), (48, 341), (48, 342), (48, 343), (48, 344), (48, 345), (48, 346), (48, 347), (48, 348), (48, 349), (48, 350), (48, 351), (48, 352), (48, 353), (48, 354), (48, 355), (48, 356), (48, 357), (48, 358), (48, 359), (48, 360), (48, 361), (48, 362), (48, 363), (48, 364), (48, 365), (48, 366), (48, 367), (48, 368), (48, 369), (48, 370), (48, 371), (48, 372), (48, 373), (48, 374), (48, 375), (48, 376), (48, 377), (48, 378), (48, 379), (48, 380), (48, 381), (48, 382), (48, 383), (48, 384), (48, 385), (48, 386), (48, 387), (48, 388), (48, 389), (48, 390), (48, 391), (48, 392), (48, 393), (48, 394), (48, 395), (48, 396), (48, 397), (48, 398), (48, 399), (48, 400), (48, 401), (48, 402), (48, 403), (48, 404), (48, 405), (48, 406), (48, 407), (48, 408), (48, 409), (48, 410), (48, 411), (48, 412), (48, 413), (48, 414), (48, 415), (48, 416), (48, 417), (48, 418), (48, 419), (48, 420), (48, 421), (48, 422), (48, 423), (48, 424), (48, 425), (48, 426), (48, 427), (48, 428), (48, 429), (48, 430), (48, 431), (49, 432), (50, 433), (51, 434), (52, 434), (53, 434), (54, 434), (55, 434), (56, 434), (57, 434), (58, 434), (59, 434), (60, 434), (61, 434), (62, 434), (63, 434), (64, 434), (65, 434), (66, 434), (67, 434), (68, 434), (69, 434), (70, 434), (71, 434), (72, 434), (73, 434), (74, 434), (75, 434), (76, 434), (77, 434), (78, 434), (79, 434), (80, 434), (81, 434), (82, 434), (83, 434), (84, 434), (85, 434), (86, 434), (87, 434), (88, 434), (89, 434), (90, 434), (91, 434), (92, 434), (93, 434), (94, 434), (95, 434), (96, 434), (97, 434), (98, 434), (99, 434), (100, 434), (101, 434), (102, 434), (103, 434), (104, 434), (105, 434), (106, 434), (107, 434), (108, 434), (109, 434), (110, 434), (111, 434), (112, 434), (113, 434), (114, 434), (115, 434), (116, 434), (117, 434), (118, 434), (119, 434), (120, 434), (121, 434), (122, 434), (123, 434), (124, 434), (125, 434), (126, 434), (127, 434), (128, 434), (129, 434), (130, 434), (131, 434), (132, 434), (133, 434), (134, 434), (135, 434), (136, 434), (137, 434), (138, 434), (139, 434), (140, 434), (141, 434), (142, 434), (143, 434), (144, 434), (145, 433), (145, 432), (145, 431), (145, 430), (145, 429), (145, 428), (145, 427), (145, 426), (145, 425), (145, 424), (145, 423), (145, 422), (145, 421), (145, 420), (145, 419), (145, 418), (145, 417), (145, 416), (145, 415), (145, 414), (145, 413), (145, 412), (145, 411), (145, 410), (145, 409), (145, 408), (145, 407), (145, 406), (145, 405), (145, 404), (145, 403), (145, 402), (145, 401), (145, 400), (145, 399), (145, 398), (145, 397), (145, 396), (145, 395), (145, 394), (145, 393), (145, 392), (145, 391), (145, 390), (145, 389), (145, 388), (145, 387), (145, 386), (145, 385), (145, 384), (145, 383), (145, 382), (145, 381), (145, 380), (145, 379), (145, 378), (145, 377), (145, 376), (145, 375), (145, 374), (145, 373), (145, 372), (146, 371), (147, 370), (148, 369), (149, 368), (150, 367), (151, 366), (152, 365), (153, 364), (154, 363), (155, 362), (156, 362), (157, 362), (158, 362), (159, 362), (160, 362), (161, 362), (162, 362), (163, 362), (164, 362), (165, 362), (166, 362), (167, 362), (168, 362), (169, 362), (170, 362), (171, 362), (172, 362), (173, 362), (174, 362), (175, 362), (176, 362), (177, 362), (178, 362), (179, 362), (180, 362), (181, 362), (182, 362), (183, 362), (184, 362), (185, 362), (186, 362), (187, 362), (188, 362), (189, 362), (190, 362), (191, 362), (192, 362), (193, 362), (194, 362), (195, 362), (196, 362), (197, 362), (198, 362), (199, 362), (200, 362), (201, 362), (202, 362), (203, 362), (204, 362), (205, 362), (206, 362), (207, 362), (208, 362), (209, 362), (210, 362), (211, 362), (212, 362), (213, 362), (214, 362), (215, 362), (216, 362), (217, 362), (218, 362), (219, 362), (220, 362), (221, 362), (222, 362), (223, 362), (224, 362), (225, 362), (226, 362), (227, 362), (228, 362), (229, 362), (230, 362), (231, 362), (232, 362), (233, 362), (234, 362), (235, 362), (236, 362), (237, 362), (238, 362), (239, 362), (240, 362), (241, 362), (242, 362), (243, 362), (244, 362), (245, 362), (246, 362), (247, 362), (248, 362), (249, 362), (250, 362), (251, 362), (252, 362), (253, 362), (254, 362), (255, 362), (256, 362), (257, 362), (258, 362), (259, 362), (260, 362), (261, 362), (262, 362), (263, 362), (264, 362), (265, 362), (266, 362), (267, 362), (268, 362), (269, 362), (270, 362), (271, 362), (272, 362), (273, 362), (274, 362), (275, 362), (276, 362), (277, 362), (278, 362), (279, 362), (280, 362), (281, 362), (282, 362), (283, 362), (284, 362), (285, 362), (286, 362), (287, 362), (288, 362), (289, 362), (290, 362), (291, 362), (292, 362), (293, 362), (294, 362), (295, 362), (296, 362), (297, 362), (298, 362), (299, 362), (300, 362), (301, 362), (302, 362), (303, 362), (304, 362), (305, 362), (306, 362), (307, 362), (308, 362), (309, 362), (310, 362), (311, 362), (312, 362), (313, 362), (314, 362), (315, 362), (316, 362), (317, 362), (318, 362), (319, 362), (320, 362), (321, 362), (322, 362), (323, 362), (324, 362), (325, 362), (326, 362), (327, 362), (328, 362), (329, 362), (330, 362), (331, 362), (332, 362), (333, 362), (334, 362), (335, 362), (336, 362), (337, 362), (338, 362), (339, 362), (340, 362), (341, 362), (342, 362), (343, 362), (344, 362), (345, 362), (346, 362), (347, 362), (348, 362), (349, 362), (350, 361), (351, 360), (352, 359), (353, 358), (354, 357), (355, 356), (356, 355), (357, 354), (358, 353), (359, 352), (360, 351), (360, 350), (360, 349), (360, 348), (360, 347), (360, 346), (360, 345), (360, 344), (360, 343), (360, 342), (360, 341), (360, 340), (360, 339), (360, 338), (360, 337), (360, 336), (360, 335), (360, 334), (360, 333), (360, 332), (360, 331), (360, 330), (360, 329), (360, 328), (360, 327), (360, 326), (360, 325), (360, 324), (360, 323), (360, 322), (360, 321), (360, 320), (360, 319), (360, 318), (360, 317), (360, 316), (360, 315), (360, 314), (360, 313), (360, 312), (360, 311), (360, 310), (360, 309), (360, 308), (360, 307), (360, 306), (360, 305), (360, 304), (360, 303), (360, 302), (360, 301), (360, 300), (360, 299), (360, 298), (360, 297), (360, 296), (360, 295), (360, 294), (360, 293), (360, 292), (360, 291), (360, 290), (360, 289), (360, 288), (360, 287), (360, 286), (360, 285), (360, 284), (360, 283), (360, 282), (360, 281), (360, 280), (360, 279), (360, 278), (360, 277), (360, 276), (360, 275), (360, 274), (360, 273), (360, 272), (360, 271), (360, 270), (360, 269), (360, 268), (360, 267), (360, 266), (360, 265), (360, 264), (360, 263), (360, 262), (360, 261), (360, 260), (360, 259), (360, 258), (360, 257), (360, 256), (360, 255), (360, 254), (360, 253), (360, 252), (360, 251), (360, 250), (360, 249), (360, 248), (360, 247), (360, 246), (360, 245), (360, 244), (360, 243), (360, 242), (360, 241), (360, 240), (360, 239), (360, 238), (360, 237), (360, 236), (360, 235), (360, 234), (360, 233), (360, 232), (360, 231), (360, 230), (360, 229), (360, 228), (360, 227), (360, 226), (360, 225), (360, 224), (360, 223), (360, 222), (360, 221), (360, 220), (360, 219), (360, 218), (360, 217), (360, 216), (360, 215), (360, 214), (360, 213), (360, 212), (360, 211), (360, 210), (360, 209), (360, 208), (360, 207), (360, 206), (360, 205), (360, 204), (360, 203), (360, 202), (360, 201), (360, 200), (360, 199), (360, 198), (360, 197), (360, 196), (360, 195), (360, 194), (360, 193), (360, 192), (360, 191), (360, 190), (360, 189), (359, 188), (358, 188), (357, 188), (356, 188), (355, 188), (354, 188), (353, 188), (352, 188), (351, 188), (350, 187), (349, 187), (348, 187), (347, 187), (346, 186), (345, 186), (344, 186), (343, 185), (342, 185), (341, 185), (340, 185), (339, 184), (338, 184), (337, 184), (336, 183), (335, 183), (334, 183), (333, 183), (332, 182), (331, 182), (330, 182), (329, 182), (328, 181), (327, 181), (326, 181), (325, 180), (324, 180), (323, 180), (322, 180), (321, 179), (320, 179), (319, 179), (318, 179), (317, 178), (316, 178), (315, 178), (314, 177), (313, 177), (312, 177), (311, 177), (310, 176), (309, 176), (308, 176), (307, 176), (306, 175), (305, 175), (304, 175), (303, 174), (302, 174), (301, 174), (300, 174), (299, 173), (298, 173), (297, 173), (296, 173), (295, 172), (294, 172), (293, 172), (292, 171), (291, 171), (290, 171), (289, 171), (288, 170), (287, 170), (286, 170), (285, 170), (284, 169), (283, 169), (282, 169), (281, 168), (280, 168), (279, 168), (278, 168), (277, 167), (276, 167), (275, 167), (274, 166), (273, 166), (272, 166), (271, 166), (270, 165), (269, 165), (268, 165), (267, 165), (266, 164), (265, 164), (264, 164), (263, 163), (262, 163), (261, 163), (260, 163), (259, 162), (258, 162), (257, 162), (256, 162), (255, 161), (254, 161), (253, 161), (252, 160), (251, 160), (250, 160), (249, 160), (248, 159), (247, 159), (246, 159), (245, 159), (244, 158), (243, 158), (242, 158), (241, 157), (240, 157), (239, 157), (238, 157), (237, 156), (236, 156), (235, 156), (234, 156), (233, 155), (232, 155), (231, 155), (230, 154), (229, 154), (228, 154), (227, 154), (226, 153), (225, 153), (224, 153), (223, 152), (222, 152), (221, 152), (220, 152), (219, 151), (218, 151), (217, 151), (216, 151), (215, 150), (214, 150), (213, 150), (212, 149), (211, 149), (210, 149), (209, 149), (208, 148), (207, 147), (206, 146), (205, 145), (204, 144), (203, 143), (202, 142), (201, 141), (200, 140), (200, 139), (200, 138), (200, 137), (200, 136), (200, 135), (200, 134), (200, 133), (200, 132), (200, 131), (200, 130), (200, 129), (200, 128), (200, 127), (200, 126), (200, 125), (200, 124), (200, 123), (200, 122), (200, 121), (200, 120), (200, 119), (200, 118), (200, 117), (200, 116), (200, 115), (200, 114), (200, 113), (200, 112), (200, 111), (200, 110), (200, 109), (200, 108), (200, 107), (200, 106), (200, 105), (200, 104), (200, 103), (200, 102), (200, 101), (200, 100), (200, 99), (200, 98), (200, 97), (200, 96), (200, 95), (200, 94), (200, 93), (200, 92), (200, 91), (200, 90), (200, 89), (200, 88), (200, 87), (200, 86), (200, 85), (200, 84), (200, 83), (200, 82), (200, 81), (200, 80), (200, 79), (200, 78), (200, 77), (200, 76), (200, 75), (200, 74), (200, 73), (200, 72), (200, 71), (200, 70), (200, 69), (200, 68), (200, 67), (200, 66), (201, 65), (202, 65), (203, 65), (204, 65), (205, 65), (206, 65), (207, 65), (208, 65), (209, 65), (210, 65), (211, 65), (212, 65), (213, 65), (214, 65), (215, 65), (216, 65), (217, 65), (218, 65), (219, 65), (220, 65), (221, 65), (222, 65), (223, 65), (224, 65), (225, 65), (226, 65), (227, 65), (228, 65), (229, 65), (230, 65), (231, 65), (232, 65), (233, 65), (234, 65), (235, 65), (236, 65), (237, 65), (238, 65), (239, 65), (240, 65), (241, 65), (242, 65), (243, 65), (244, 65), (245, 65), (246, 65), (247, 65), (248, 65), (249, 65), (250, 65), (251, 65), (252, 65), (253, 65), (254, 65), (255, 65), (256, 65), (257, 65), (258, 65), (259, 65), (260, 65), (261, 65), (262, 65), (263, 65), (264, 65), (265, 65), (266, 65), (267, 65), (268, 65), (269, 65), (270, 65), (271, 65), (272, 65), (273, 65), (274, 65), (275, 65), (276, 65), (277, 65), (278, 65), (279, 65), (280, 65), (281, 65), (282, 65), (283, 65), (284, 65), (285, 65), (286, 65), (287, 65), (288, 65), (289, 65), (290, 65), (291, 65), (292, 65), (293, 65), (294, 65), (295, 65), (296, 65), (297, 65), (298, 65), (299, 65), (300, 65), (301, 65), (302, 65), (303, 65), (304, 65), (305, 65), (306, 65), (307, 65), (308, 65), (309, 65), (310, 65), (311, 65), (312, 65), (313, 65), (314, 65), (315, 65), (316, 65), (317, 65), (318, 65), (319, 65), (320, 65), (321, 65), (322, 65), (323, 65), (324, 65), (325, 65), (326, 65), (327, 65), (328, 65), (329, 65), (330, 65), (331, 65), (332, 65), (333, 65), (334, 65), (335, 65), (336, 65), (337, 65), (338, 65), (339, 65), (340, 65), (341, 65), (342, 65), (343, 65), (344, 65), (345, 65), (346, 65), (347, 65), (348, 65), (349, 65), (350, 65), (351, 65), (352, 65), (353, 65), (354, 65), (355, 65), (356, 65), (357, 65), (358, 65), (359, 65), (360, 65), (361, 65), (362, 65), (363, 65), (364, 65), (365, 65), (366, 65), (367, 65), (368, 65), (369, 65), (370, 65), (371, 65), (372, 65), (373, 65), (374, 65), (375, 65), (376, 65), (377, 65), (378, 65), (379, 65), (380, 65), (381, 65), (382, 65), (383, 65), (384, 65), (385, 65), (386, 65), (387, 65), (388, 65), (389, 65), (390, 65), (391, 65), (392, 65), (393, 65), (394, 65), (395, 65), (396, 65), (397, 65), (398, 65), (399, 65), (400, 65), (401, 65), (402, 65), (403, 65), (404, 65), (405, 65), (406, 65), (407, 65), (408, 65), (409, 65), (410, 65), (411, 65), (412, 65), (413, 65), (414, 65), (415, 65), (416, 65), (417, 65), (418, 65), (419, 65), (420, 65), (421, 65), (422, 65), (423, 65), (424, 65), (425, 65), (426, 65), (427, 65), (428, 65), (429, 65), (430, 65), (431, 65), (432, 65), (433, 65), (434, 65), (435, 65), (436, 65), (437, 65), (438, 65), (439, 65), (440, 65), (441, 65), (442, 65), (443, 65), (444, 65), (445, 65), (446, 65), (447, 65), (448, 65), (449, 65), (450, 65), (451, 65), (452, 65), (453, 65), (454, 65), (455, 65), (456, 65), (457, 65), (458, 65), (459, 65), (460, 65), (461, 65), (462, 65), (463, 65), (464, 65), (465, 65), (466, 65), (467, 65), (468, 65), (469, 65), (470, 65), (471, 65), (472, 65), (473, 65), (474, 65), (475, 65), (476, 65), (477, 65), (478, 65), (479, 65), (480, 65), (481, 65), (482, 65), (483, 64), (484, 63), (485, 62), (486, 61), (487, 60), (488, 59), (489, 58), (490, 57), (491, 56), (492, 55), (493, 54), (494, 53), (495, 52), (496, 51), (497, 50), (498, 49), (499, 48), (500, 47), (501, 47), (502, 47), (503, 47), (504, 47), (505, 47), (506, 47), (507, 47), (508, 47), (509, 47), (510, 47), (511, 47), (512, 47), (513, 47), (514, 47), (515, 47), (516, 47), (517, 47), (518, 47), (519, 47), (520, 47), (521, 47), (522, 47), (523, 47), (524, 47), (525, 47), (526, 47), (527, 47), (528, 47), (529, 47), (530, 47), (531, 47), (532, 47), (533, 47), (534, 47), (535, 47), (536, 47), (537, 47), (538, 47), (539, 47), (540, 47), (541, 47), (542, 47), (543, 47), (544, 47), (545, 47), (546, 47), (547, 47), (548, 47), (549, 47), (550, 47), (551, 47), (552, 47), (553, 47), (554, 47), (555, 47), (556, 47), (557, 47), (558, 47), (559, 47), (560, 47), (561, 47), (562, 47), (563, 47), (564, 47), (565, 47), (566, 47), (567, 47), (568, 47), (569, 47), (570, 47), (571, 47), (572, 47), (573, 47), (574, 47), (575, 47), (576, 47), (577, 47), (578, 47), (579, 47), (580, 47), (581, 47), (582, 47), (583, 47), (584, 47), (585, 47), (586, 47), (587, 47), (588, 46), (589, 45)]
pathx = []
pathy = []
for i in range(0,len(path),10):
    #path[i] = (path[i][0]*1.5/480,2*path[i][1]/640)
    path[i] = (path[i][0]*1.5/480,2*path[i][1]/640)
    pathx.append(path[i][0])
    pathy.append(1.5-path[i][1])

robot = DifferentialDrive(0.1,0.06,pathx[0],pathy[0],3*3.1415/2,0.1,0)

fig = plt.figure()
ax1 = fig.add_subplot(1,1,1)
img = plt.imread('../map-pics/test2.png')
init_time = time.time()
last_updated = init_time

ani = animation.FuncAnimation(fig, update, interval=100)
plt.show()
    
#robot.pure_pursuit((0,0),[(1,1)],1,1)